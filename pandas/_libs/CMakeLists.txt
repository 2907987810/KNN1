set(BASIC_LIBRARIES arrays groupby hashing indexing internals reduction ops properties reshape sparse testing writers)
foreach(LIB ${BASIC_LIBRARIES})
  add_library(${LIB} SHARED ${LIB}.c)
  target_include_directories(${LIB} PRIVATE ${Python_INCLUDE_DIRS} ${Python_NumPy_INCLUDE_DIRS})
  target_link_libraries(${LIB} ${Python_LIBRARIES})
endforeach()

set(KLIB_REQUIRING algos hashtable join)
foreach(LIB ${KLIB_REQUIRING})
  add_library(${LIB} SHARED ${LIB}.c)
  target_include_directories(${LIB} PRIVATE ${Python_INCLUDE_DIRS} ${Python_NumPy_INCLUDE_DIRS} "src/klib")
  target_link_libraries(${LIB} ${Python_LIBRARIES})
endforeach()

set(KLIB_AND_TSLIBS_REQUIRING index interval)
foreach(LIB ${KLIB_AND_TSLIBS_REQUIRING})
  add_library(${LIB} SHARED ${LIB}.c)
  target_include_directories(${LIB} PRIVATE ${Python_INCLUDE_DIRS} ${Python_NumPy_INCLUDE_DIRS} "src/klib" "./tslibs")
  target_link_libraries(${LIB} ${Python_LIBRARIES})
endforeach()

SET(TSLIBS_REQUIRING missing tslib)
foreach(LIB ${TSLIBS_REQUIRING})
  add_library(${LIB} SHARED ${LIB}.c)
  target_include_directories(${LIB} PRIVATE ${Python_INCLUDE_DIRS} ${Python_NumPy_INCLUDE_DIRS} "./tslibs")
  target_link_libraries(${LIB} ${Python_LIBRARIES})
endforeach()

add_subdirectory("tslibs")

# Depends on tokenizer being built
#include ("src/parser")
#set(PARSER_REQUIRING lib parsers)
#foreach(LIB ${PARSER_REQUIRING})
#add_library(lib SHARED lib.c)
#target_include_directories(lib PRIVATE ${Python_INCLUDE_DIRS} ${Python_NumPy_INCLUDE_DIRS} "src/klib" "./tslibs" "src/parser")
#target_link_libraries(lib ${Python_LIBRARIES})
